# 잘못된 보안 설정
## 요약
시스템 설치 시 기본적으로 설치되는 불필요한 기능이나 환경 설정, 보안 설정을 수정하지 않고 사용하는 경우 기본 계정, 휴면 페이지, 패치되지 않은 결함 등에 따른 취약점이 존재할 수 있으며, 이런 취약점들은 취약점 점검 툴 등을 통해 쉽게 검출되어 공격에 사용되기도 한다.

## 디렉터리 리스팅
웹 서버 운영 시 특정 디렉터리에 디폴트 파일(index.html, default.html 등)이 없는 경우 해당 디렉터리의 파일 리스트를 브라우저로 보여주게 되는 취약점이다.

### 원인
웹 서버의 특정 디렉터리 요청에 대해 디폴트 페이지가 설정되어 있으나, 해당 페이지가 존재하지 않다면 요청한 디렉터리에 대한 목록이 보이도록 웹 서버가 설정되어 있는 경우

### 취약점 진단
- 디폴트 페이지 요청 시 디렉터리 목록이 출력되는지 확인한다.
   - URL 경로 중 확인하고자 하는 디렉터리까지만 주소 창에 입력하여 디렉터리 목록을 볼 수 있는지 확인
- 구글 검색을 통해 디렉터리 목록 정보를 얻을 수 있는지 확인한다.
   - `intitle:index of`, `parent Directory`, `부모 디렉토리로 이동` 등의 검색어 입력
- 웹 취약점 진단 도구를 사용하여 디렉터리 목록이 노출되는지 확인한다.
   - Paros 툴 이용

해결책은 다음과 같다.

- 디렉터리 리스팅 취약점 제거를 위한 톰캣 서버 설정
   - `web.xml`에서 디렉터리 리스팅 정책을 설정한다.
   ```xml
   <init-param>
        <param-name>listings</param-name>
        <param-value>false</param-value>
   </init-param>
   ```
- 디렉터리 리스팅 취약점 제거를 위한 아파치 서버 설정
   - `httpd.conf` 파일에서 <Directory> 설정에서 Options 값에 설정된 Indexes 속성을 None으로 변경한다.
   ```xml
   <Directory "/usr/local/apache2/htdocs">
        # Options Indexes FollowSymLinks
        Options None
        AllowOverride None
        Order allow,deny
        Allow from all
   </Directory>
   ```
- 디렉터리 리스팅 취약점 제거를 위한 IIS 서버 설정
   - `[제어판]-[관리도구]-[IIS(인터넷 서비스) 관리자]-[기능 보기]-[디렉터리 검색]` 화면에서 더블 클릭을 통해 [사용]을 [사용 안 함]으로 변경한다.


## 에러 노출
사용자의 요청을 처리하는 동안 예외가 발생했을 때 해당 예외를 애플리케이션이나 서버에서 충분히 처리하지 못한다면, 웹 서버는 예외가 발생한 상황의 스택 정보나 데이터베이스 에러 정보를 브라우저에 출력해 시스템 정보를 노출할 수 있다.

### 원인
프로그램에서 예외 처리에 대한 코드가 제대로 구현되지 않은 경우, 발생된 예외는 시스템에 전달된다. 이 경우 시스템의 디폴트 동작은 예외가 발생한 상황의 스택정보를 클라이언트인 브라우저로 출력하여 시스템 정보가 노출된다.

### 취약점 진단
- 입력값을 조작하여 에러메시지가 노출되는지 체크
- DB 쿼리에 사용되는 입력값을 조작하여 에러메시지가 노출되는지 체크
- 자동화 도구를 이용하여 에러메시지가 노출되는지 체크

해결책은 다음과 같다.

- 예외발생시 지정된 에러페이지가 사용자에게 응답되도록 설정
   - 톰캣 서버 설정
   - IIS 서버 설정
   - Apache 서버 설정
- SpringMVC 프레임워크의 설정 파일 사용하여 디폴트 에러페이지 설정



## 참고
- 실무에 바로 적용하는 해킹방어를 위한 JAVA 시큐어코딩
